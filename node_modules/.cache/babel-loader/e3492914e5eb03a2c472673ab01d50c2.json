{"ast":null,"code":"import _regeneratorRuntime from\"/Users/charlyagudelo/Documents/proyDanny/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/charlyagudelo/Documents/proyDanny/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/charlyagudelo/Documents/proyDanny/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _objectSpread from\"/Users/charlyagudelo/Documents/proyDanny/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import React from\"react\";import firebase from\"../components/database/firebase\";import{config}from\"../components/config/config\";var UserStateContext=React.createContext();var UserDispatchContext=React.createContext();var showName,showIdentification,showEmail,showDependence,showDependenceName;var dependence,goods,type;function userReducer(state,action){switch(action.type){case\"LOGIN_SUCCESS\":return _objectSpread(_objectSpread({},state),{},{isAuthenticated:true});case\"SIGN_OUT_SUCCESS\":return _objectSpread(_objectSpread({},state),{},{isAuthenticated:false});default:{throw new Error(\"Unhandled action type: \".concat(action.type));}}}function UserProvider(_ref){var children=_ref.children;var _React$useReducer=React.useReducer(userReducer,{isAuthenticated:!!localStorage.getItem(\"id_token\")}),_React$useReducer2=_slicedToArray(_React$useReducer,2),state=_React$useReducer2[0],dispatch=_React$useReducer2[1];return/*#__PURE__*/React.createElement(UserStateContext.Provider,{value:state},/*#__PURE__*/React.createElement(UserDispatchContext.Provider,{value:dispatch},children));}function useUserState(){var context=React.useContext(UserStateContext);if(context===undefined){throw new Error(\"useUserState must be used within a UserProvider\");}return context;}function useUserDispatch(){var context=React.useContext(UserDispatchContext);if(context===undefined){throw new Error(\"useUserDispatch must be used within a UserProvider\");}return context;}export{UserProvider,useUserState,useUserDispatch,userLogin,userRegistry,userRegistrySave,signOut,showName,showIdentification,dependence,showEmail,showDependence,showDependenceName,saveGood,goods};// ###########################################################\nfunction userLogin(dispatch,email,password,history,setIsLoading,setError,setAnswer){if(email===\"\"&&password===\"\"){//Alert.alert('Campos vacíos', 'Ingresa tu correo y contraseña', [{ style: 'destructive' }])\nsetError(true);}else{setError(false);setIsLoading(true);firebase.auth().signInWithEmailAndPassword(email,password).then(function(res){console.log(res.user);showName=res.user.displayName;showEmail=res.user.email;console.log(\"User logged-in successfully!\");getUser(showEmail,history,setIsLoading,setError,setAnswer,dispatch);}).catch(function(error){setError(true);setIsLoading(false);setAnswer(true);console.log(error);});}}//Registry\nfunction userRegistry(setIsLoading,history){setIsLoading(true);getDependences(setIsLoading,history);}function userRegistrySave(_x,_x2,_x3,_x4,_x5,_x6,_x7,_x8,_x9,_x10){return _userRegistrySave.apply(this,arguments);}function _userRegistrySave(){_userRegistrySave=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(identification,name,lastname,email,password,password2,history,setIsLoading,setError,setAnswer){var response,json;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setError(false);setIsLoading(true);_context.next=5;return fetch(\"\".concat(config.APIFireBase,\"/api/user\"),{crossDomain:true,method:\"POST\",headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"Access-Control-Allow-Methods\":\"DELETE, POST, GET, OPTIONS\"},body:JSON.stringify({id:identification,name:name,lastname:lastname,email:email,password:password,fk_dependence:\"0hSRJuu0Zrwq0w0euTyH\"})},{mode:\"cors\"});case 5:response=_context.sent;_context.next=8;return response;case 8:json=_context.sent;type=\"Registro\";responseApi(json,setIsLoading,setError,setAnswer,history,type);_context.next=18;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);setError(true);setAnswer(true);console.error(_context.t0);case 18:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return _userRegistrySave.apply(this,arguments);}function responseApi(res,setIsLoading,setError,setAnswer,history,type){console.log(\"esto es la respuesta\",res.description,res.json());if(typeof res.error!==\"undefined\"){setIsLoading(false);setError(true);console.log(\"Upps!\",res.error);}else{if(typeof res.status===\"undefined\"||res.status!==200){setIsLoading(false);setError(true);setAnswer(true);console.log(JSON.stringify(res));console.log(\"Upps!\",\"Algo pasó, intenta de nuevo\");}else{if(res.status==200){setError(null);setIsLoading(false);if(type==\"Registro\"){history.push(\"/\");}else{if(type==\"Bienes\"){history.push(\"/app/dashboard\");}}console.log(\"respuesta!!!!!!!!!\",res);}else{setError(true);setIsLoading(false);setAnswer(true);console.log(\"Upps!\",\"Algo pasó intenta de nuevo\",res);}}}}function saveGood(_x11,_x12,_x13,_x14,_x15,_x16,_x17,_x18,_x19,_x20,_x21,_x22){return _saveGood.apply(this,arguments);}function _saveGood(){_saveGood=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(nameGood,description,idPlate,place,physical_space,brand_and_serie,state,reason,history,setIsLoading,setError,setAnswer){var response,json;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setError(false);setIsLoading(true);_context2.next=5;return fetch(\"\".concat(config.APIFireBase,\"/api/good\"),{crossDomain:true,method:\"POST\",headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"Access-Control-Allow-Methods\":\"DELETE, POST, GET, OPTIONS\"},body:JSON.stringify({name:nameGood,description:description,idPlate:idPlate,place:place,fk_dependence:showDependence,physical_space:physical_space,brand_and_serie:brand_and_serie,state:state,reason:reason})},{mode:\"cors\"});case 5:response=_context2.sent;_context2.next=8;return response;case 8:json=_context2.sent;type=\"Bienes\";responseApi(json,setIsLoading,setError,setAnswer,history,type);_context2.next=18;break;case 13:_context2.prev=13;_context2.t0=_context2[\"catch\"](0);setError(true);setAnswer(true);console.error(_context2.t0);case 18:case\"end\":return _context2.stop();}}},_callee2,null,[[0,13]]);}));return _saveGood.apply(this,arguments);}function getDependenceByFk(setIsLoading,history){try{fetch(\"\".concat(config.APIFireBase,\"/api/dependence?id=\").concat(showDependence),{crossDomain:true,method:\"GET\",headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"Access-Control-Allow-Methods\":\"DELETE, POST, GET, OPTIONS\"}},{mode:\"cors\"}).then(function(resp){return resp.json();}).then(function(data){setIsLoading(false);showDependenceName=data.dependence_name;console.log(showDependenceName);history.push(\"/app/dashboard\");}).catch(function(error){setIsLoading(false);console.log(error);});}catch(error){console.error(error);}}function getDependences(setIsLoading,history){try{fetch(\"\".concat(config.APIFireBase,\"/api/dependencies\"),{crossDomain:true,method:\"GET\",headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"Access-Control-Allow-Methods\":\"DELETE, POST, GET, OPTIONS\"}},{mode:\"cors\"}).then(function(resp){return resp.json();}).then(function(data){setIsLoading(false);dependence=data;console.log(dependence);history.push(\"/registry\");}).catch(function(error){setIsLoading(false);console.log(error);});//responseApi(json, setIsLoading,setError, setAnswer,history);\n}catch(error){console.error(error);}}function getGoods(setIsLoading,history){try{fetch(\"\".concat(config.APIFireBase,\"/api/goods?id=\").concat(showDependence),{crossDomain:true,method:\"GET\",headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"Access-Control-Allow-Methods\":\"DELETE, POST, GET, OPTIONS\"}},{mode:\"cors\"}).then(function(resp){return resp.json();}).then(function(data){goods=data;console.log(goods);getDependenceByFk(setIsLoading,history);}).catch(function(error){setIsLoading(false);console.log(error);});//responseApi(json, setIsLoading,setError, setAnswer,history);\n}catch(error){console.error(error);}}function getUser(showEmail,history,setIsLoading,setError,setAnswer,dispatch){try{fetch(\"\".concat(config.APIFireBase,\"/api/user?email=\").concat(showEmail),{crossDomain:true,method:\"GET\",headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\",\"Access-Control-Allow-Origin\":\"*\",\"Access-Control-Allow-Methods\":\"DELETE, POST, GET, OPTIONS\"}},{mode:\"cors\"}).then(function(resp){return resp.json();}).then(function(data){showIdentification=data.userInfo.id;showDependence=data.userInfo.fk_dependence;console.log(showIdentification);console.log(\"Usuario obtenido\",data,showEmail);setError(null);setIsLoading(false);dispatch({type:\"LOGIN_SUCCESS\"});getGoods(setIsLoading,history);// history.push(\"/app/dashboard\");\n}).catch(function(error){console.log(error);});}catch(error){console.error(error);}}function signOut(dispatch,history){localStorage.removeItem(\"id_token\");dispatch({type:\"SIGN_OUT_SUCCESS\"});history.push(\"/login\");}","map":{"version":3,"sources":["/Users/charlyagudelo/Documents/proyDanny/front/src/context/UserContext.js"],"names":["React","firebase","config","UserStateContext","createContext","UserDispatchContext","showName","showIdentification","showEmail","showDependence","showDependenceName","dependence","goods","type","userReducer","state","action","isAuthenticated","Error","UserProvider","children","useReducer","localStorage","getItem","dispatch","useUserState","context","useContext","undefined","useUserDispatch","userLogin","userRegistry","userRegistrySave","signOut","saveGood","email","password","history","setIsLoading","setError","setAnswer","auth","signInWithEmailAndPassword","then","res","console","log","user","displayName","getUser","catch","error","getDependences","identification","name","lastname","password2","fetch","APIFireBase","crossDomain","method","headers","Accept","body","JSON","stringify","id","fk_dependence","mode","response","json","responseApi","description","status","push","nameGood","idPlate","place","physical_space","brand_and_serie","reason","getDependenceByFk","resp","data","dependence_name","getGoods","userInfo","removeItem"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport firebase from \"../components/database/firebase\";\nimport { config } from \"../components/config/config\";\n\nvar UserStateContext = React.createContext();\nvar UserDispatchContext = React.createContext();\nvar showName, showIdentification, showEmail, showDependence, showDependenceName;\nvar dependence, goods, type;\nfunction userReducer(state, action) {\n  switch (action.type) {\n    case \"LOGIN_SUCCESS\":\n      return { ...state, isAuthenticated: true };\n    case \"SIGN_OUT_SUCCESS\":\n      return { ...state, isAuthenticated: false };\n    default: {\n      throw new Error(`Unhandled action type: ${action.type}`);\n    }\n  }\n}\n\nfunction UserProvider({ children }) {\n  var [state, dispatch] = React.useReducer(userReducer, {\n    isAuthenticated: !!localStorage.getItem(\"id_token\"),\n  });\n\n  return (\n    <UserStateContext.Provider value={state}>\n      <UserDispatchContext.Provider value={dispatch}>\n        {children}\n      </UserDispatchContext.Provider>\n    </UserStateContext.Provider>\n  );\n}\n\nfunction useUserState() {\n  var context = React.useContext(UserStateContext);\n  if (context === undefined) {\n    throw new Error(\"useUserState must be used within a UserProvider\");\n  }\n  return context;\n}\n\nfunction useUserDispatch() {\n  var context = React.useContext(UserDispatchContext);\n  if (context === undefined) {\n    throw new Error(\"useUserDispatch must be used within a UserProvider\");\n  }\n  return context;\n}\n\nexport {\n  UserProvider,\n  useUserState,\n  useUserDispatch,\n  userLogin,\n  userRegistry,\n  userRegistrySave,\n  signOut,\n  showName,\n  showIdentification,\n  dependence,\n  showEmail,\n  showDependence,\n  showDependenceName,\n  saveGood,\n  goods\n};\n\n// ###########################################################\n\nfunction userLogin(\n  dispatch,\n  email,\n  password,\n  history,\n  setIsLoading,\n  setError,\n  setAnswer\n) {\n  if (email === \"\" && password === \"\") {\n    //Alert.alert('Campos vacíos', 'Ingresa tu correo y contraseña', [{ style: 'destructive' }])\n    setError(true);\n  } else {\n    setError(false);\n    setIsLoading(true);\n    firebase\n      .auth()\n      .signInWithEmailAndPassword(email, password)\n      .then((res) => {\n        console.log(res.user);\n        showName = res.user.displayName;\n        showEmail = res.user.email;\n        console.log(\"User logged-in successfully!\");\n        getUser(\n          showEmail,\n          history,\n          setIsLoading,\n          setError,\n          setAnswer,\n          dispatch\n        );\n      })\n      .catch((error) => {\n        setError(true);\n        setIsLoading(false);\n        setAnswer(true);\n        console.log(error);\n      });\n  }\n}\n\n//Registry\n\nfunction userRegistry(setIsLoading, history) {\n  setIsLoading(true);\n  getDependences(setIsLoading, history);\n}\n\nasync function userRegistrySave(\n  identification,\n  name,\n  lastname,\n  email,\n  password,\n  password2,\n  history,\n  setIsLoading,\n  setError,\n  setAnswer\n) {\n  try {\n    setError(false);\n    setIsLoading(true);\n    let response = await fetch(\n      `${config.APIFireBase}/api/user`,\n      {\n        crossDomain: true,\n        method: \"POST\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          \"Access-Control-Allow-Origin\": \"*\",\n          \"Access-Control-Allow-Methods\": \"DELETE, POST, GET, OPTIONS\",\n        },\n\n        body: JSON.stringify({\n          id: identification,\n          name: name,\n          lastname: lastname,\n          email: email,\n          password: password,\n          fk_dependence: \"0hSRJuu0Zrwq0w0euTyH\",\n        }),\n      },\n      { mode: \"cors\" }\n    );\n    let json = await response;\n    type=\"Registro\";\n    responseApi(json, setIsLoading, setError, setAnswer, history, type);\n  } catch (error) {\n    setError(true);\n    setAnswer(true);\n    console.error(error);\n  }\n}\n\nfunction responseApi(res, setIsLoading, setError, setAnswer, history, type) {\n  console.log(\"esto es la respuesta\", res.description, res.json());\n  if (typeof res.error !== \"undefined\") {\n    setIsLoading(false);\n    setError(true);\n    console.log(\"Upps!\", res.error);\n  } else {\n    if (typeof res.status === \"undefined\" || res.status !== 200) {\n      setIsLoading(false);\n      setError(true);\n      setAnswer(true);\n      console.log(JSON.stringify(res));\n      console.log(\"Upps!\", \"Algo pasó, intenta de nuevo\");\n    } else {\n      if (res.status == 200) {\n        setError(null);\n        setIsLoading(false);\n        if(type==\"Registro\"){\n          history.push(\"/\");\n        }else{\n          if(type == \"Bienes\"){\n            history.push(\"/app/dashboard\")\n          }\n        }\n        console.log(\"respuesta!!!!!!!!!\", res);\n      } else {\n        setError(true);\n        setIsLoading(false);\n        setAnswer(true);\n        console.log(\"Upps!\", \"Algo pasó intenta de nuevo\", res);\n      }\n    }\n  }\n}\nasync function saveGood(\n  nameGood,\n  description,\n  idPlate,\n  place,\n  physical_space,\n  brand_and_serie,\n  state,\n  reason,\n  history,\n  setIsLoading,\n  setError,\n  setAnswer\n) {\n  try {\n    setError(false);\n    setIsLoading(true);\n    let response = await fetch(\n      `${config.APIFireBase}/api/good`,\n      {\n        crossDomain: true,\n        method: \"POST\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          \"Access-Control-Allow-Origin\": \"*\",\n          \"Access-Control-Allow-Methods\": \"DELETE, POST, GET, OPTIONS\",\n        },\n\n        body: JSON.stringify({\n          name: nameGood,\n          description: description,\n          idPlate: idPlate,\n          place: place,\n          fk_dependence: showDependence,\n          physical_space: physical_space,\n          brand_and_serie: brand_and_serie,\n          state: state,\n          reason: reason,\n        }),\n      },\n      { mode: \"cors\" }\n    );\n    let json = await response;\n    type=\"Bienes\";\n    responseApi(json, setIsLoading, setError, setAnswer, history, type);\n  } catch (error) {\n    setError(true);\n    setAnswer(true);\n    console.error(error);\n  }\n}\n\nfunction getDependenceByFk(setIsLoading, history) {\n  try {\n    fetch(\n      `${config.APIFireBase}/api/dependence?id=${showDependence}`,\n      {\n        crossDomain: true,\n        method: \"GET\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          \"Access-Control-Allow-Origin\": \"*\",\n          \"Access-Control-Allow-Methods\": \"DELETE, POST, GET, OPTIONS\",\n        },\n      },\n      { mode: \"cors\" }\n    )\n      .then((resp) => resp.json())\n      .then(function (data) {\n        setIsLoading(false);\n        showDependenceName = data.dependence_name;\n        console.log(showDependenceName);\n        history.push(\"/app/dashboard\");\n      })\n      .catch(function (error) {\n        setIsLoading(false);\n        console.log(error);\n      });\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nfunction getDependences(setIsLoading, history) {\n  try {\n    fetch(\n      `${config.APIFireBase}/api/dependencies`,\n      {\n        crossDomain: true,\n        method: \"GET\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          \"Access-Control-Allow-Origin\": \"*\",\n          \"Access-Control-Allow-Methods\": \"DELETE, POST, GET, OPTIONS\",\n        },\n      },\n      { mode: \"cors\" }\n    )\n      .then((resp) => resp.json())\n      .then(function (data) {\n        setIsLoading(false);\n        dependence = data;\n        console.log(dependence);\n        history.push(\"/registry\");\n      })\n      .catch(function (error) {\n        setIsLoading(false);\n        console.log(error);\n      });\n    //responseApi(json, setIsLoading,setError, setAnswer,history);\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nfunction getGoods(setIsLoading, history) {\n  try {\n    fetch(\n      `${config.APIFireBase}/api/goods?id=${showDependence}`,\n      {\n        crossDomain: true,\n        method: \"GET\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          \"Access-Control-Allow-Origin\": \"*\",\n          \"Access-Control-Allow-Methods\": \"DELETE, POST, GET, OPTIONS\",\n        },\n      },\n      { mode: \"cors\" }\n    )\n      .then((resp) => resp.json())\n      .then(function (data) {\n        goods = data;\n        console.log(goods);\n        getDependenceByFk(setIsLoading, history)\n      })\n      .catch(function (error) {\n        setIsLoading(false);\n        console.log(error);\n      });\n    //responseApi(json, setIsLoading,setError, setAnswer,history);\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nfunction getUser(\n  showEmail,\n  history,\n  setIsLoading,\n  setError,\n  setAnswer,\n  dispatch\n) {\n  try {\n    fetch(\n      `${config.APIFireBase}/api/user?email=${showEmail}`,\n      {\n        crossDomain: true,\n        method: \"GET\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          \"Access-Control-Allow-Origin\": \"*\",\n          \"Access-Control-Allow-Methods\": \"DELETE, POST, GET, OPTIONS\",\n        },\n      },\n      { mode: \"cors\" }\n    )\n      .then((resp) => resp.json())\n      .then(function (data) {\n        showIdentification = data.userInfo.id;\n        showDependence = data.userInfo.fk_dependence;\n        console.log(showIdentification);\n        console.log(\"Usuario obtenido\", data, showEmail);\n        setError(null);\n        setIsLoading(false);\n        dispatch({ type: \"LOGIN_SUCCESS\" });\n        getGoods(setIsLoading, history);\n       // history.push(\"/app/dashboard\");\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  } catch (error) {\n    console.error(error);\n  }\n}\nfunction signOut(dispatch, history) {\n  localStorage.removeItem(\"id_token\");\n  dispatch({ type: \"SIGN_OUT_SUCCESS\" });\n  history.push(\"/login\");\n}\n"]},"metadata":{},"sourceType":"module"}