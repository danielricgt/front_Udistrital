{"ast":null,"code":"var _jsxFileName = \"/Users/charlyagudelo/Documents/proyDanny/front_Udistrital/src/context/UserContext.js\";\nimport React from \"react\";\nimport firebase from \"../components/database/firebase\";\nimport { config } from \"../components/config/config\";\nvar UserStateContext = React.createContext();\nvar UserDispatchContext = React.createContext();\nvar showName, showIdentification, showEmail, showTypeUser;\n\nfunction userReducer(state, action) {\n  switch (action.type) {\n    case \"LOGIN_SUCCESS\":\n      return { ...state,\n        isAuthenticated: true\n      };\n\n    case \"SIGN_OUT_SUCCESS\":\n      return { ...state,\n        isAuthenticated: false\n      };\n\n    default:\n      {\n        throw new Error(`Unhandled action type: ${action.type}`);\n      }\n  }\n}\n\nfunction UserProvider({\n  children\n}) {\n  var [state, dispatch] = React.useReducer(userReducer, {\n    isAuthenticated: !!localStorage.getItem(\"id_token\")\n  });\n  return /*#__PURE__*/React.createElement(UserStateContext.Provider, {\n    value: state,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(UserDispatchContext.Provider, {\n    value: dispatch,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 7\n    }\n  }, children));\n}\n\nfunction useUserState() {\n  var context = React.useContext(UserStateContext);\n\n  if (context === undefined) {\n    throw new Error(\"useUserState must be used within a UserProvider\");\n  }\n\n  return context;\n}\n\nfunction useUserDispatch() {\n  var context = React.useContext(UserDispatchContext);\n\n  if (context === undefined) {\n    throw new Error(\"useUserDispatch must be used within a UserProvider\");\n  }\n\n  return context;\n}\n\nexport { UserProvider, useUserState, useUserDispatch, userLogin, signOut, showName, showIdentification, showEmail, showTypeUser }; // -----٩(˘◡˘)۶------\n\nfunction userLogin(dispatch, email, password, history, setIsLoading, setError, setAnswer) {\n  if (email === \"\" && password === \"\") {\n    setError(true);\n  } else {\n    setError(false);\n    setIsLoading(true);\n    firebase.auth().signInWithEmailAndPassword(email, password).then(res => {\n      console.log(res.user);\n      showName = res.user.displayName;\n      showEmail = res.user.email;\n      console.log(\"User logged-in successfully!\");\n      getUser(showEmail, history, setIsLoading, setError, setAnswer, dispatch);\n    }).catch(error => {\n      setError(true);\n      setIsLoading(false);\n      setAnswer(true);\n      console.log(error);\n    });\n  }\n} // -----٩(˘◡˘)۶------\n\n\nfunction getUser(showEmail, history, setIsLoading, setError, setAnswer, dispatch) {\n  try {\n    fetch(`${config.APIGraphql}`, {\n      crossDomain: true,\n      method: \"POST\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        \"Access-Control-Allow-Origin\": \"*\",\n        \"Access-Control-Allow-Methods\": \"DELETE, POST, GET, OPTIONS\"\n      },\n      body: JSON.stringify({\n        query: `\n          query MyQuery {\n            usuario(where: { correo:{_eq: \"${showEmail}\"}}) {\n              nombres\n              apellidos\n              correo\n              estado\n              fk_cargo\n              fk_dependencia\n              id\n            }\n          }\n          `\n      })\n    }, {\n      mode: \"cors\"\n    }).then(resp => resp.json()).then(function (data) {\n      console.log(\"email\", showEmail); //showIdentification = data.data.usuario[0].id;\n\n      showTypeUser = data.data.usuario[0].fk_cargo; //console.log(showIdentification);\n\n      console.log(\"Usuario obtenido\", data, showEmail); //validateUser(showTypeUser, history, setError,setIsLoading);\n\n      history.push(\"/app/dashboard\"); // setError(null);\n      // setIsLoading(false);\n      // getGoods(setIsLoading, history);\n      // history.push(\"/app/dashboard\");\n    }).catch(function (error) {\n      console.log(error);\n    });\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nfunction signOut(dispatch, history) {\n  localStorage.removeItem(\"id_token\");\n  dispatch({\n    type: \"SIGN_OUT_SUCCESS\"\n  });\n  history.push(\"/login\");\n}","map":{"version":3,"sources":["/Users/charlyagudelo/Documents/proyDanny/front_Udistrital/src/context/UserContext.js"],"names":["React","firebase","config","UserStateContext","createContext","UserDispatchContext","showName","showIdentification","showEmail","showTypeUser","userReducer","state","action","type","isAuthenticated","Error","UserProvider","children","dispatch","useReducer","localStorage","getItem","useUserState","context","useContext","undefined","useUserDispatch","userLogin","signOut","email","password","history","setIsLoading","setError","setAnswer","auth","signInWithEmailAndPassword","then","res","console","log","user","displayName","getUser","catch","error","fetch","APIGraphql","crossDomain","method","headers","Accept","body","JSON","stringify","query","mode","resp","json","data","usuario","fk_cargo","push","removeItem"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport firebase from \"../components/database/firebase\";\nimport { config } from \"../components/config/config\";\n\nvar UserStateContext = React.createContext();\nvar UserDispatchContext = React.createContext();\n\nvar showName, showIdentification, showEmail, showTypeUser;\n\nfunction userReducer(state, action) {\n  switch (action.type) {\n    case \"LOGIN_SUCCESS\":\n      return { ...state, isAuthenticated: true };\n    case \"SIGN_OUT_SUCCESS\":\n      return { ...state, isAuthenticated: false };\n    default: {\n      throw new Error(`Unhandled action type: ${action.type}`);\n    }\n  }\n}\n\nfunction UserProvider({ children }) {\n  var [state, dispatch] = React.useReducer(userReducer, {\n    isAuthenticated: !!localStorage.getItem(\"id_token\"),\n  });\n\n  return (\n    <UserStateContext.Provider value={state}>\n      <UserDispatchContext.Provider value={dispatch}>\n        {children}\n      </UserDispatchContext.Provider>\n    </UserStateContext.Provider>\n  );\n}\n\nfunction useUserState() {\n  var context = React.useContext(UserStateContext);\n  if (context === undefined) {\n    throw new Error(\"useUserState must be used within a UserProvider\");\n  }\n  return context;\n}\n\nfunction useUserDispatch() {\n  var context = React.useContext(UserDispatchContext);\n  if (context === undefined) {\n    throw new Error(\"useUserDispatch must be used within a UserProvider\");\n  }\n  return context;\n}\n\nexport {\n  UserProvider,\n  useUserState,\n  useUserDispatch,\n  userLogin,\n  signOut,\n  showName,\n  showIdentification,\n  showEmail,\n  showTypeUser\n};\n\n\n// -----٩(˘◡˘)۶------\n\nfunction userLogin(\n  dispatch,\n  email,\n  password,\n  history,\n  setIsLoading,\n  setError,\n  setAnswer\n) {\n  if (email === \"\" && password === \"\") {\n    setError(true);\n  } else {\n    setError(false);\n    setIsLoading(true);\n    firebase\n      .auth()\n      .signInWithEmailAndPassword(email, password)\n      .then((res) => {\n        console.log(res.user);\n        showName = res.user.displayName;\n        showEmail = res.user.email;\n        console.log(\"User logged-in successfully!\");\n        getUser(\n          showEmail,\n          history,\n          setIsLoading,\n          setError,\n          setAnswer,\n          dispatch\n        );\n      })\n      .catch((error) => {\n        setError(true);\n        setIsLoading(false);\n        setAnswer(true);\n        console.log(error);\n      });\n  }\n}\n\n// -----٩(˘◡˘)۶------\nfunction getUser(\n  showEmail,\n  history,\n  setIsLoading,\n  setError,\n  setAnswer,\n  dispatch\n) {\n  try {\n\n    fetch(\n      `${config.APIGraphql}`,\n      {\n        crossDomain: true,\n        method: \"POST\",\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n          \"Access-Control-Allow-Origin\": \"*\",\n          \"Access-Control-Allow-Methods\": \"DELETE, POST, GET, OPTIONS\",\n        },\n        body: JSON.stringify({\n          query: \n          `\n          query MyQuery {\n            usuario(where: { correo:{_eq: \"${showEmail}\"}}) {\n              nombres\n              apellidos\n              correo\n              estado\n              fk_cargo\n              fk_dependencia\n              id\n            }\n          }\n          `         \n        }),\n      },\n      { mode: \"cors\" }\n    )\n      .then((resp) => resp.json())\n      .then(function (data) {\n        console.log(\"email\", showEmail)\n        //showIdentification = data.data.usuario[0].id;\n        showTypeUser = data.data.usuario[0].fk_cargo;\n        //console.log(showIdentification);\n        console.log(\"Usuario obtenido\", data, showEmail);\n        //validateUser(showTypeUser, history, setError,setIsLoading);\n        history.push(\"/app/dashboard\");\n        // setError(null);\n        // setIsLoading(false);\n       // getGoods(setIsLoading, history);\n       // history.push(\"/app/dashboard\");\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  } catch (error) {\n    console.error(error);\n  }\n}\n\n\nfunction signOut(dispatch, history) {\n  localStorage.removeItem(\"id_token\");\n  dispatch({ type: \"SIGN_OUT_SUCCESS\" });\n  history.push(\"/login\");\n}\n"]},"metadata":{},"sourceType":"module"}